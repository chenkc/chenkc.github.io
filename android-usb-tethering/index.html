<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Android USB Tethering - chenkc</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="refer: Original link
Tethering means sharing the Internet connection of an Internet-capable mobile phone with other devices. This sharing can be offered over a wireless LAN (Wi-Fi), or over Bluetooth,">
<meta property="og:type" content="article">
<meta property="og:title" content="Android USB Tethering">
<meta property="og:url" content="http://chenkc.github.io/android-usb-tethering/index.html">
<meta property="og:site_name" content="chenkc">
<meta property="og:description" content="refer: Original link
Tethering means sharing the Internet connection of an Internet-capable mobile phone with other devices. This sharing can be offered over a wireless LAN (Wi-Fi), or over Bluetooth,">
<meta property="og:updated_time" content="2016-04-21T08:05:41.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android USB Tethering">
<meta name="twitter:description" content="refer: Original link
Tethering means sharing the Internet connection of an Internet-capable mobile phone with other devices. This sharing can be offered over a wireless LAN (Wi-Fi), or over Bluetooth,">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
  <link href="/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
      <a id="logo" class="logo logo-text" href="/">sw-otaku</a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://chenkc.github.io"></form>
        </div>
      </nav>
    </div>
  </div>
</header>
    <section id="main" class="outer"><article id="post-android-usb-tethering" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Android USB Tethering
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/android-usb-tethering/" class="article-date">
  <time datetime="2016-03-22T08:56:30.000Z" itemprop="datePublished">2016-03-22</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/android/">android</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>refer: <a href="https://wiki.gentoo.org/wiki/Android_USB_Tethering" target="_blank" rel="external">Original link</a></p>
<p>Tethering means sharing the Internet connection of an Internet-capable mobile phone with other devices. This sharing can be offered over a wireless LAN (Wi-Fi), or over Bluetooth, or by physical connection using a cable (Tethering).</p>
<p>Our focus in this article will be the USB tethering.<br>Your Android mobile phone can behave as an external network interface usbN, connected via the USB infrastructure. The usbN interface is in turn connected to the mobile phone LAN, providing dhcp server, DNS server, gateway and so on.<br>Thatâ€™s how your mobile phone can provide an Internet connection to another device.</p>
<p>Android phones are already equipped to provide this functionality. Simply connect the USB cable and go to Settings -&gt; Wireless settings -&gt; Tethering -&gt; Tethering USB.</p>
<p>What you need is some kernel and network configuration on the other side (e.g. your laptop).</p>
<p>Contents<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1 <span class="selector-tag">Kernel</span> <span class="selector-tag">configuration</span></span><br><span class="line">2 <span class="selector-tag">Tested</span> <span class="selector-tag">Devices</span></span><br><span class="line">3 <span class="selector-tag">Testing</span></span><br><span class="line">4 <span class="selector-tag">Connecting</span></span><br><span class="line">    4<span class="selector-class">.1</span> <span class="selector-tag">Manually</span></span><br><span class="line">    4<span class="selector-class">.2</span> <span class="selector-tag">Permanent</span> <span class="selector-tag">configuration</span></span><br><span class="line">    4<span class="selector-class">.3</span> <span class="selector-tag">Checks</span></span><br><span class="line">5 <span class="selector-tag">Advanced</span> <span class="selector-tag">network</span> <span class="selector-tag">settings</span></span><br></pre></td></tr></table></figure></p>
<h2 id="Kernel-configuration"><a href="#Kernel-configuration" class="headerlink" title="Kernel configuration"></a>Kernel configuration</h2><p>KERNEL .config 3.0.6-gentoo</p>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">G<span class="function"><span class="title">eneral</span> setup  ---&gt;</span></span><br><span class="line">    [*] Prompt <span class="keyword">for</span> development <span class="built_in">and</span>/<span class="built_in">or</span> incomplete code/drivers</span><br><span class="line">D<span class="function"><span class="title">evice</span> Drivers ---&gt;</span></span><br><span class="line">    [*] N<span class="function"><span class="title">etwork</span> device support ---&gt;</span></span><br><span class="line">        USB N<span class="function"><span class="title">etwork</span> Adapters ---&gt;</span></span><br><span class="line">            [*] Multi-purpose USB Networking Framework</span><br><span class="line">                &lt;M&gt; CDC Ethernet support</span><br><span class="line">                &lt;M&gt; CDC EEM support</span><br><span class="line">                &lt;M&gt; Simple USB Network Links (CDC Ethernet subset)</span><br><span class="line">                &lt;M&gt;   Host <span class="keyword">for</span> RNDIS <span class="built_in">and</span> ActiveSync devices</span><br><span class="line">            [*] Embedded ARM Linux links</span><br></pre></td></tr></table></figure>
<p>KERNEL .config 3.12.21-gentoo-r1</p>
<figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Device</span> <span class="type">Drivers</span> <span class="comment">---&gt;</span></span><br><span class="line">    [*] <span class="type">Network</span> device sup<span class="keyword">port</span> <span class="comment">---&gt;</span></span><br><span class="line">        <span class="type">USB</span> <span class="type">Network</span> <span class="type">Adapters</span> <span class="comment">---&gt;</span></span><br><span class="line">            [<span class="type">M</span>] <span class="type">Multi</span>-purpose <span class="type">USB</span> <span class="type">Networking</span> <span class="type">Framework</span></span><br><span class="line">                &lt;<span class="type">M</span>&gt; <span class="type">CDC</span> <span class="type">Ethernet</span> sup<span class="keyword">port</span></span><br><span class="line">                &lt;<span class="type">M</span>&gt; <span class="type">CDC</span> <span class="type">EEM</span> sup<span class="keyword">port</span></span><br><span class="line">                [<span class="type">M</span>] <span class="type">Simple</span> <span class="type">USB</span> <span class="type">Network</span> <span class="type">Links</span> (<span class="type">CDC</span> <span class="type">Ethernet</span> subset)</span><br><span class="line">                    [*] <span class="type">Embedded</span> <span class="type">ARM</span> <span class="type">Linux</span> links</span><br></pre></td></tr></table></figure>
<p>You can either build the options in the kernel or leave them as module.</p>
<p>Note. The RNDIS option seems to be needed in some situation only. See this thread to learn more.</p>
<h2 id="Tested-Devices"><a href="#Tested-Devices" class="headerlink" title="Tested Devices"></a>Tested Devices</h2><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">Google</span> Nexus One (<span class="keyword">Android </span><span class="number">2</span>.<span class="number">3</span>.<span class="number">6</span> <span class="keyword">build </span>GRK39F)</span><br><span class="line"><span class="symbol">Google</span> Nexus <span class="number">4</span> (<span class="keyword">Android </span><span class="number">4</span>.<span class="number">3</span> <span class="keyword">build </span>JWR66Y - uses rndis_host)</span><br><span class="line"><span class="symbol">HTC</span> One M7 (Sense <span class="number">5</span>.<span class="number">5</span>, <span class="keyword">Android </span><span class="number">4</span>.<span class="number">3</span>, Software number <span class="number">3</span>.<span class="number">62</span>.<span class="number">401</span>.<span class="number">1</span>,HTC SDK API level <span class="number">5</span>.<span class="number">65</span> - I used rndis_host, cdc_ether <span class="keyword">and </span>usbnet modules ONLY to <span class="meta">get</span> <span class="keyword">it </span>to work)</span><br><span class="line"><span class="symbol">LG</span> P350 (<span class="keyword">Android </span><span class="number">2</span>.<span class="number">2</span>.<span class="number">1</span> <span class="keyword">build </span>FRG83)</span><br><span class="line"><span class="symbol">LG</span> E400 (<span class="keyword">Android </span><span class="number">2</span>.<span class="number">3</span>.<span class="number">6</span> <span class="keyword">build </span>GRK39F)</span><br><span class="line"><span class="symbol">LG</span> L7 P705 (<span class="keyword">Android </span><span class="number">4</span>.<span class="number">1</span>.<span class="number">2</span> <span class="keyword">build </span>JZO54K)</span><br><span class="line"><span class="symbol">Motorola</span> Defy (<span class="keyword">Android </span><span class="number">2</span>.<span class="number">3</span>.<span class="number">7</span> Cyanogenmod <span class="number">7</span>)</span><br><span class="line"><span class="symbol">Motorola</span> Moto G <span class="number">4</span>G <span class="number">2013</span> (<span class="number">1</span>st Gen) (<span class="keyword">Android </span><span class="number">5</span>.<span class="number">1</span>) -- needed rndis_host module -- User:mercuriete</span><br><span class="line"><span class="symbol">Samsung</span> Galaxy S i9000</span><br><span class="line"><span class="symbol">Samsung</span> Galaxy Nexus i9250 (<span class="keyword">Android </span><span class="number">4</span>.<span class="number">0</span>.<span class="number">1</span> <span class="keyword">ITL41D)</span><br><span class="line"></span><span class="symbol">Samsung</span> Galaxy <span class="built_in">S2</span></span><br><span class="line"><span class="symbol">Samsung</span> Galaxy <span class="built_in">S3</span> (GT-I9300 <span class="keyword">Android </span><span class="number">4</span>.<span class="number">3</span> Stock Rom)</span><br><span class="line"><span class="symbol">Sony</span> Xperia Go (St27i <span class="keyword">Android </span><span class="number">4</span>.<span class="number">1</span>.<span class="number">2</span> Stock Rom <span class="keyword">build </span>no <span class="number">6</span>.<span class="number">2</span>.A.<span class="number">1</span>.<span class="number">100</span> -- needed rndis_host module for me - User:LordVan )</span><br><span class="line"><span class="symbol">HTC</span> Desire HD (<span class="keyword">Android </span><span class="number">2</span>.<span class="number">3</span>.<span class="number">6</span> Stock Rom <span class="keyword">build </span><span class="keyword">and </span><span class="keyword">Android </span><span class="number">4</span>.<span class="number">4</span>.<span class="number">4</span> (unofficial CyanogenMod <span class="number">11</span>) -- needed rndis_host module for <span class="keyword">both </span>Roms)</span><br><span class="line"><span class="symbol">Huawei</span> Honor <span class="number">4</span>x (unofficial CyanogenMod <span class="number">11</span> / <span class="keyword">Android </span><span class="number">4</span>.<span class="number">4</span>.<span class="number">4</span>, works great) -- needed rndis_host module AleiPhoenix (talk) <span class="number">13</span>:<span class="number">57</span>, <span class="number">3</span> July <span class="number">2015</span> (UTC)</span><br><span class="line"><span class="symbol">Samsung</span> Galaxy <span class="built_in">S4</span> Mini Duos (GT-I9192, unofficial CyanogenMod <span class="number">12</span>.<span class="number">1</span> / <span class="keyword">Android </span><span class="number">5</span>.<span class="number">1</span>) -- needed rndis_host module</span><br></pre></td></tr></table></figure>
<h2 id="Testing"><a href="#Testing" class="headerlink" title="Testing"></a>Testing</h2><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">root #dmesg</span><br><span class="line"></span><br><span class="line">usb <span class="number">1</span>-<span class="number">7</span>: <span class="keyword">New</span> USB device found, idVendor=<span class="number">18</span>d1, idProduct=<span class="number">4</span>e13</span><br><span class="line">usb <span class="number">1</span>-<span class="number">7</span>: <span class="keyword">New</span> USB device strings: Mfr=<span class="number">1</span>, Product=<span class="number">2</span>, SerialNumber=<span class="number">3</span></span><br><span class="line">usb <span class="number">1</span>-<span class="number">7</span>: Product: Nexus One</span><br><span class="line">usb <span class="number">1</span>-<span class="number">7</span>: Manufacturer: Google, Inc.</span><br><span class="line">usb <span class="number">1</span>-<span class="number">7</span>: SerialNumber: HT9CSP803294</span><br><span class="line">usb <span class="number">1</span>-<span class="number">7</span>: usb_probe_device</span><br><span class="line">usb <span class="number">1</span>-<span class="number">7</span>: configuration <span class="string">#1</span> chosen <span class="keyword">from</span> <span class="number">1</span> choice</span><br><span class="line">usb <span class="number">1</span>-<span class="number">7</span>: adding <span class="number">1</span>-<span class="number">7</span>:<span class="number">1.0</span> (config <span class="string">#1</span>, <span class="keyword">interface</span> <span class="number">0</span>)</span><br><span class="line">rndis_host <span class="number">1</span>-<span class="number">7</span>:<span class="number">1.0</span>: usb_probe_interface</span><br><span class="line">rndis_host <span class="number">1</span>-<span class="number">7</span>:<span class="number">1.0</span>: usb_probe_interface - got id</span><br><span class="line">rndis_host <span class="number">1</span>-<span class="number">7</span>:<span class="number">1.0</span>: usb0: <span class="keyword">register</span> <span class="string">'rndis_host'</span> at usb-<span class="number">0000</span>:<span class="number">00</span>:<span class="number">1</span>d.<span class="number">7</span>-<span class="number">7</span>, RNDIS device, ea:<span class="number">61</span>:<span class="number">37</span>:<span class="number">88</span>:a2:e5</span><br><span class="line">usb <span class="number">1</span>-<span class="number">7</span>: adding <span class="number">1</span>-<span class="number">7</span>:<span class="number">1.1</span> (config <span class="string">#1</span>, <span class="keyword">interface</span> <span class="number">1</span>)</span><br><span class="line">drivers/usb/core/inode.c: creating file <span class="string">'004'</span></span><br><span class="line">hub <span class="number">1</span>-<span class="number">0</span>:<span class="number">1.0</span>: state <span class="number">7</span> ports <span class="number">8</span> chg <span class="number">0000</span> evt fe80</span><br><span class="line">uhci_hcd <span class="number">0000</span>:<span class="number">00</span>:<span class="number">1</span>d.<span class="number">0</span>: reserve dev <span class="number">2</span> ep81-INT, period <span class="number">8</span>, phase <span class="number">4</span>, <span class="number">93</span> us</span><br><span class="line">usb <span class="number">1</span>-<span class="number">7</span>: link qh32-<span class="number">0001</span>/ffff88021aa4bc80 start <span class="number">1</span> [<span class="number">1</span>/<span class="number">0</span> us]</span><br><span class="line">usb0: no IPv6 routers present</span><br></pre></td></tr></table></figure>
<p><code>root #ifconfig -a</code></p>
<p>If you see usb0 (or whatever number youâ€™ll get) you are all set.</p>
<h2 id="Connecting"><a href="#Connecting" class="headerlink" title="Connecting"></a>Connecting</h2><p>Since the mobile phone LAN changes its addresses, you need a DHCP client to configure the usbN device.</p>
<p>If you are on a laptop, you probably have a DHCP client. If not, emerge net-misc/dhcpcd.</p>
<p><code>root #emerge --ask net-misc/dhcpcd</code></p>
<h3 id="Manually"><a href="#Manually" class="headerlink" title="Manually"></a>Manually</h3><p>Simply run dhcpcd after plug/mobile activation.</p>
<p><code>root #dhcpcd usb0</code></p>
<h3 id="Permanent-configuration"><a href="#Permanent-configuration" class="headerlink" title="Permanent configuration"></a>Permanent configuration</h3><p>Edit your /etc/conf.d/net to have a permanent, automatic activation of the interface.</p>
<p><code>root #echo &quot;config_usb0=\&quot;dhcp\&quot;&quot; &gt;&gt; /etc/conf.d/net</code></p>
<p>Once plugged in and activated on the mobile phone side, the usb0 will be up and configured.</p>
<h3 id="Checks"><a href="#Checks" class="headerlink" title="Checks"></a>Checks</h3><p>Run the usual checks to verify your connection.</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root <span class="selector-id">#ifconfig</span> usb0</span><br><span class="line">root <span class="selector-id">#route</span></span><br><span class="line">root <span class="selector-id">#cat</span> /etc/resolv.conf</span><br></pre></td></tr></table></figure>
<h2 id="Advanced-network-settings"><a href="#Advanced-network-settings" class="headerlink" title="Advanced network settings"></a>Advanced network settings</h2><p>The DHCP is very quick, but the default settings donâ€™t give you as much freedom as you may want.</p>
<p>A possible scenario is that you are in a corporate, protected LAN context that doesnâ€™t give you the Internet connection but where you need to stay connected to have access to some Intranet resource.<br>Or maybe you have a free but limited connection (a public wifi allowing http only, an evil firewall, etc.). Since mobile connections could be expensive, you could want to save your money up using the tethering only when needed.<br>Here is a handful of examples about the DHCP usage.</p>
<p>If you want to limit the information set by DHPC, you can fine-tune its behaviour.</p>
<p>E.g.:<br><code>root #dhcpcd --nogateway --nohook resolv.conf --nohook hostname usb0</code></p>
<p>This will let your default gateway, resolv.conf and hostname as they are, letting you provide extra info by hand.</p>
<p>E.g.:<br><code>root #route add -host my_sshd_remote_host_IP dev usb0</code></p>
<p>Finally, you can permanently configure your USB network interface.<br>E.g.</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">FILE /etc/conf.d/net</span><br><span class="line"></span><br><span class="line">config_usb0=<span class="string">"dhcp"</span></span><br><span class="line">dhcpcd_usb0=<span class="string">"--nogateway --nohook resolv.conf --nohook hostname"</span></span><br><span class="line"># Special hosts</span><br><span class="line">postup()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="string">[[ "usb0" == $&#123;IFACE&#125; ]]</span>; <span class="keyword">then</span></span><br><span class="line">        route add -host my_sshd_remote_host_IP dev usb0</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Generally, you can avoid every DHCP setting (see the man page) but gather them with</p>
<p><code>root #dhcpcd -U usb0</code></p>
<p>Then you can set what you want in the postup hook.</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/usb-tethering/">usb tethering</a></li></ul>

      </footer>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/hexo-how-to/" id="article-nav-newer" class="article-nav-link-wrap">
      <div class="article-nav-title"><span>&lt;</span>&nbsp;
        
          Hexo-how-to
        
      </div>
    </a>
  
  
    <a href="/introduction-to-cross-compiling/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Introduction to cross-compiling&nbsp;<span>&gt;</span></div>
    </a>
  
</nav>

  
</article>

</section>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 i.am.chenkc&nbsp;
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    

<script src="/js/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
  </div>
</body>
</html>